<app-header></app-header>
<main class="container">
    <div class="breadcrumb">
        Trang ch·ªß > Mua xe c≈©
    </div>

    <h1 class="page-title">Mua b√°n xe √¥ t√¥ c≈© m·ªõi gi√° t·ªët ∆∞u ƒë√£i 07/2025</h1>
    <div class="promo-banner">
        <img src="https://e-cdn.carpla.vn/carpla-ecom/cms/toyotacantho-1747121816.802.png?image_process=format,webp/resize,w_1080"
            srcset="https://e-cdn.carpla.vn/carpla-ecom/cms/toyotacantho-1747121816.802.png?image_process=format,webp/resize,w_1080 1x, https://e-cdn.carpla.vn/carpla-ecom/cms/toyotacantho-1747121816.802.png?image_process=format,webp/resize,w_2048 2x"
            alt="Toyota C·∫ßn Th∆° Banner"
            style="width:100%;max-width:100%;height:auto;display:block;margin:18px auto 24px auto;border-radius:12px;box-shadow:0 2px 8px rgba(0,0,0,0.08);" />
    </div>

    <div class="main-wrapper">
        <div class="main-content">
            <div class="search-banner">
                <div class="search-banner-content">
                    <h2>T√¨m xe ch√≠nh h√£ng<br>Ch·ªçn Carpla.vn</h2>
                    <div class="search-input-group">
                        <input type="text" [(ngModel)]="searchInput" (keyup.enter)="onSearchTitle()"
                            placeholder="T√¨m ki·∫øm theo h√£ng xe, m·∫´u xe, s·ªë ch·ªó...">
                        <button (click)="onSearchTitle()">T√¨m ki·∫øm</button>
                    </div>
                </div>
                <div class="search-banner-image"></div>
            </div>

            <div class="filter-section">
                <h4>Khu v·ª±c</h4>
                <div class="filter-buttons">
                    <button [class.active]="!filter.location" (click)="onSelectLocation('')">T·∫•t c·∫£</button>
                    <button [class.active]="filter.location === 'H√† N·ªôi'" (click)="onSelectLocation('H√† N·ªôi')">H√†
                        N·ªôi</button>
                    <button [class.active]="filter.location === 'H·ªì Ch√≠ Minh'"
                        (click)="onSelectLocation('H·ªì Ch√≠ Minh')">H·ªì Ch√≠ Minh</button>
                    <button [class.active]="filter.location === 'ƒê√† N·∫µng'" (click)="onSelectLocation('ƒê√† N·∫µng')">ƒê√†
                        N·∫µng</button>
                    <button [class.active]="filter.location === 'C·∫ßn Th∆°'" (click)="onSelectLocation('C·∫ßn Th∆°')">C·∫ßn
                        Th∆°</button>
                    <button [class.active]="filter.location === 'B√¨nh D∆∞∆°ng'"
                        (click)="onSelectLocation('B√¨nh D∆∞∆°ng')">B√¨nh D∆∞∆°ng</button>
                    <button [class.active]="filter.location === 'An Giang'" (click)="onSelectLocation('An Giang')">An
                        Giang</button>
                    <button id="show-province-modal" (click)="showProvinceModal = true">Xem th√™m</button>

                </div>
                <div id="province-modal" class="province-modal" *ngIf="showProvinceModal">
                    <div class="province-modal-content">
                        <span class="close" (click)="showProvinceModal = false">&times;</span>
                        <h3>Ch·ªçn khu v·ª±c</h3>
                        <input type="text" class="province-search" placeholder="T√¨m ki·∫øm t·ªânh th√†nh...">
                        <div class="province-list">
                            <button [class.active]="!filter.location"
                                (click)="onSelectLocation(''); showProvinceModal = false">T·∫•t c·∫£</button>

                            <button
                                *ngFor="let province of ['H√† N·ªôi', 'H·ªì Ch√≠ Minh', 'ƒê√† N·∫µng', 'C·∫ßn Th∆°', 'B√¨nh D∆∞∆°ng', 'An Giang', 'B·∫Øc Giang', 'B·∫Øc K·∫°n', 'B·∫°c Li√™u', 'B·∫Øc Ninh', 'B·∫øn Tre', 'B√¨nh ƒê·ªãnh', 'B√¨nh Ph∆∞·ªõc', 'B√¨nh Thu·∫≠n', 'C√† Mau', 'Cao B·∫±ng', 'ƒê·∫Øk L·∫Øk', 'ƒê·∫Øk N√¥ng', 'ƒêi·ªán Bi√™n', 'ƒê·ªìng Nai', 'ƒê·ªìng Th√°p', 'Gia Lai', 'H√† Giang', 'H√† Nam', 'H√† Tƒ©nh', 'H·∫£i D∆∞∆°ng', 'H·∫£i Ph√≤ng', 'H·∫≠u Giang', 'H√≤a B√¨nh', 'H∆∞ng Y√™n', 'Kh√°nh H√≤a', 'Ki√™n Giang', 'Kon Tum', 'Lai Ch√¢u', 'L√¢m ƒê·ªìng', 'L·∫°ng S∆°n', 'L√†o Cai', 'Long An', 'Nam ƒê·ªãnh', 'Ngh·ªá An', 'Ninh B√¨nh', 'Ninh Thu·∫≠n', 'Ph√∫ Th·ªç', 'Ph√∫ Y√™n', 'Qu·∫£ng B√¨nh', 'Qu·∫£ng Nam', 'Qu·∫£ng Ng√£i', 'Qu·∫£ng Ninh', 'Qu·∫£ng Tr·ªã', 'S√≥c TrƒÉng', 'S∆°n La', 'T√¢y Ninh', 'Th√°i B√¨nh', 'Th√°i Nguy√™n', 'Thanh H√≥a', 'Th·ª´a Thi√™n Hu·∫ø', 'Ti·ªÅn Giang', 'Tr√† Vinh', 'Tuy√™n Quang', 'Vƒ©nh Long', 'Vƒ©nh Ph√∫c', 'Y√™n B√°i']"
                                [class.active]="filter.location === province"
                                (click)="onSelectLocation(province); showProvinceModal = false">
                                {{province}}
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="filter-section">
                <h4>NƒÉm s·∫£n xu·∫•t</h4>
                <div class="filter-buttons">
                    <button [class.active]="!filter.year" (click)="onSelectYear('')">T·∫•t c·∫£</button>
                    <button *ngFor="let year of [2025, 2024, 2023, 2022, 2021, 2020, 2019, 2018]"
                        [class.active]="filter.year === year" (click)="onSelectYear(year.toString())">
                        {{year}}
                    </button>
                    <button id="show-year-modal" (click)="showYearModal = true">Xem th√™m</button>

                </div>
                <div id="year-modal" class="year-modal" *ngIf="showYearModal">
                    <div class="year-modal-content">
                        <span class="close" (click)="showYearModal = false">&times;</span>
                        <h3>Ch·ªçn nƒÉm s·∫£n xu·∫•t</h3>
                        <input type="text" class="year-search" placeholder="T√¨m ki·∫øm nƒÉm...">
                        <div class="year-list-grid">
                            <button [class.active]="!filter.year" (click)="onSelectYear(''); showYearModal = false">T·∫•t
                                c·∫£</button>
                            <button
                                *ngFor="let year of [2025, 2024, 2023, 2022, 2021, 2020, 2019, 2018, 2017, 2016, 2015, 2014, 2013, 2012, 2011, 2010, 2009, 2008, 2007, 2006]"
                                [class.active]="filter.year === year"
                                (click)="onSelectYear(year.toString()); showYearModal = false">
                                {{year}}
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="car-listing-header">
                <div class="total-listings">T·ªïng: {{currentTotalElementsCount}} xe ƒëang b√°n</div>
                <div class="sort-options">
                    <span>S·∫Øp x·∫øp theo:</span>
                    <select>
                        <option value="moi_nhat">M·ªõi nh·∫•t</option>
                        <option value="gia_thap_cao">Gi√° th·∫•p - cao</option>
                        <option value="gia_cao_thap">Gi√° cao - th·∫•p</option>
                    </select>
                </div>
            </div>

            <div class="car-list">
                <div class="car-card-2col" *ngFor="let car of cars" (click)="goToDetail(car.carId, car.status)"
                    style="cursor:pointer;">
                    <div class="car-card-img">
                        <div class="car-card-img-content">
                            <img [src]="car.images?.[0]?.imageUrl || 'https://via.placeholder.com/320x200?text=No+Image'"
                                [alt]="car.title">
                            <div class="car-card-time">
                                <span>
                                    <svg width="18" height="18" fill="none" stroke="#ffd600" stroke-width="2"
                                        viewBox="0 0 24 24">
                                        <circle cx="12" cy="12" r="10"></circle>
                                        <polyline points="12 6 12 12 16 14"></polyline>
                                    </svg>
                                    {{ timeSince(car.createdDate) }}
                                </span>
                            </div>
                        </div>
                    </div>
                    <div class="car-card-info">
                        <div class="car-card-title">
                            <h3>{{car.title}}</h3>
                            <p class="price">{{car.price | number}} ƒë <span class="price-month">ch·ªâ t·ª´ 5,0
                                    tri·ªáu/th√°ng</span></p>
                        </div>
                        <div class="car-card-specs">
                            <span><svg width="18" height="18" fill="none" stroke="#222" stroke-width="2"
                                    viewBox="0 0 24 24">
                                    <rect x="3" y="4" width="18" height="18" rx="2" ry="2" />
                                    <line x1="16" y1="2" x2="16" y2="6" />
                                    <line x1="8" y1="2" x2="8" y2="6" />
                                    <line x1="3" y1="10" x2="21" y2="10" />
                                </svg> {{car.seats}} ch·ªó</span>
                            <span><svg width="18" height="18" fill="none" stroke="#222" stroke-width="2"
                                    viewBox="0 0 24 24">
                                    <rect x="3" y="4" width="18" height="18" rx="2" ry="2" />
                                    <line x1="16" y1="2" x2="16" y2="6" />
                                    <line x1="8" y1="2" x2="8" y2="6" />
                                    <line x1="3" y1="10" x2="21" y2="10" />
                                </svg> {{car.transmission}}</span>
                            <span><svg width="18" height="18" fill="none" stroke="#222" stroke-width="2"
                                    viewBox="0 0 24 24">
                                    <rect x="3" y="4" width="18" height="18" rx="2" ry="2" />
                                    <line x1="16" y1="2" x2="16" y2="6" />
                                    <line x1="8" y1="2" x2="8" y2="6" />
                                    <line x1="3" y1="10" x2="21" y2="10" />
                                </svg> {{car.fuelType}}</span>
                            <span><svg width="18" height="18" fill="none" stroke="#222" stroke-width="2"
                                    viewBox="0 0 24 24">
                                    <circle cx="12" cy="12" r="10" />
                                    <polyline points="12 6 12 12 16 14" />
                                </svg> {{car.mileage | number}} km</span>
                            <span><svg width="18" height="18" fill="none" stroke="#222" stroke-width="2"
                                    viewBox="0 0 24 24">
                                    <rect x="3" y="4" width="18" height="18" rx="2" ry="2" />
                                    <line x1="16" y1="2" x2="16" y2="6" />
                                    <line x1="8" y1="2" x2="8" y2="6" />
                                    <line x1="3" y1="10" x2="21" y2="10" />
                                </svg> {{car.location}}</span>
                        </div>
                    </div>
                    <div class="car-card-dealer">
                        <div class="dealer-title">
                            <img src="{{car.store?.logoUrl || 'https://via.placeholder.com/40x40?text=Logo'}}" alt="Logo">
                            <span class="dealer-name">
                                {{car.store?.storeName || 'ƒê·∫°i l√Ω b√°n l·∫ª'}}
                                <span class="dealer-vip" *ngIf="car.store?.storeName">üåª</span>
                            </span>
                        </div>
                        <div class="dealer-stats">
                            <span>ƒêang b√°n <b>{{car.store?.carAvailable}}</b></span>
                            <span>ƒê√£ b√°n <b>{{car.store?.carSold}}</b></span>
                        </div>
                        <div class="dealer-location">
                            <svg width="18" height="18" fill="none" stroke="#222" stroke-width="2" viewBox="0 0 24 24">
                                <path d="M21 10c0 6-9 13-9 13S3 16 3 10a9 9 0 1 1 18 0z" />
                                <circle cx="12" cy="10" r="3" />
                            </svg>
                            <span>{{car.store?.address || car.location}}</span>
                        </div>
                        <div class="dealer-contact">
                            <svg width="18" height="18" fill="none" stroke="#222" stroke-width="2" viewBox="0 0 24 24">
                                <path
                                    d="M22 16.92V19a2 2 0 0 1-2.18 2A19.86 19.86 0 0 1 3 5.18 2 2 0 0 1 5 3h2.09a2 2 0 0 1 2 1.72c.13 1.07.37 2.11.73 3.12a2 2 0 0 1-.45 2.11l-.27.27a16 16 0 0 0 6.29 6.29l.27-.27a2 2 0 0 1 2.11-.45c1.01.36 2.05.6 3.12.73A2 2 0 0 1 21 16.92z" />
                            </svg>
                            <span>{{car.store?.phone ? car.store?.phone?.slice(0, 4) + '******' : 'Li√™n h·ªá'}}</span>
                        </div>
                    </div>
                    <div class="favorite-button" (click)="toggleFavorite(car.carId, $event)">
                        <i class="favorite-icon" [class.favorite]="car.isFavorite"
                            [class.not-favorite]="!car.isFavorite">
                            ‚ô•
                        </i>
                    </div>
                </div>
                <div class="pagination-wrapper">
                    <ul class="pagination">
                        <li [class.disabled]="currentPage === 0" (click)="currentPage > 0 && loadCars(currentPage - 1)">
                            <span>&lt;</span>
                        </li>
                        <li *ngFor="let page of [].constructor(pagesCount); let i = index"
                            [class.active]="i === currentPage" (click)="loadCars(i)"><span>{{i + 1}}</span></li>
                        <li [class.disabled]="currentPage === pagesCount - 1"
                            (click)="currentPage < pagesCount - 1 && loadCars(currentPage + 1)"><span>&gt;</span></li>
                    </ul>
                </div>
            </div>
        </div>

        <aside class="sidebar">
            <h3>B·ªô l·ªçc
                <button (click)="resetFilters()"
                    style="float:right;font-size:12px;color:#007bff;background:none;border:none;cursor:pointer;">X√≥a
                    l·ªçc</button>
            </h3>
            <div class="filter-group">
                <h4>Tr·∫°ng th√°i xe</h4>
                <div class="filter-radio-list">
                    <label><input type="radio" name="status" [checked]="filter.status === 2"
                            (change)="onSelectStatus('2')"> Xe c≈©</label>
                    <label><input type="radio" name="status" [checked]="filter.status === 1"
                            (change)="onSelectStatus('1')"> Xe m·ªõi</label>
                </div>
            </div>
            <div class="filter-group">
                <h4>Kho·∫£ng gi√°</h4>
                <div class="filter-radio-list">
                    <label *ngFor="let range of priceRanges; let i = index">
                        <input type="radio" name="price"
                            [checked]="filter.minPrice === range.min && filter.maxPrice === range.max"
                            (change)="onSelectPrice(range.min, range.max)">
                        {{range.label}}
                    </label>
                </div>
            </div>
            <div class="filter-group">
                <h4>Ki·ªÉu d√°ng</h4>
                <div class="filter-radio-list">
                    <label
                        *ngFor="let style of ['Hatchback', 'MPV', 'Sedan', 'SUV', 'Pickup', 'CUV', 'Coupe', 'Van/Minibus', 'Xe t·∫£i', 'Xe du l·ªãch', 'Xe kh√°ch']">
                        <input type="radio" name="body" [checked]="filter.bodyStyle === style"
                            (change)="onSelectBodyStyle(style)">
                        {{style}}
                    </label>
                </div>
            </div>
            <div class="filter-group">
                <h4>S·ªë ch·ªó ng·ªìi</h4>
                <div class="filter-radio-list">
                    <label *ngFor="let seat of [2, 3, 4, 5, 7, 8, 9, 16, 29, 47]">
                        <input type="radio" name="seat" [checked]="filter.seats === seat"
                            (change)="onSelectSeats(seat)">
                        {{seat}} ch·ªó
                    </label>
                </div>
            </div>
        </aside>
    </div>
    <a href="/chat" class="floating-chat-icon" aria-label="Nh·∫Øn tin h·ªó tr·ª£">
        <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="white" viewBox="0 0 24 24">
            <path
                d="M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-2 12H6v-2h12v2zm0-3H6V9h12v2zm0-3H6V6h12v2z" />
        </svg>
    </a>
</main>

<app-footer></app-footer>